# 网络商城——学信汇软件概要设计 #

### 文件状态： 正式发布
### 文件标识：当前版本： v1.2
### 作者： 姓名 ：  李浩文 王羽桐 张天翔 何明东
### 团队： 111队




## 1引言

### 1.1编写目的
#### 从该阶段开发正式进入软件的实际开发阶段，本阶段完成系统的大致设计并明确系统的数据结构与软件结构。在软件设计阶段主要是把一个软件需求转化为软件表示的过程，这种表示只是描绘出软件的总的概貌。本概要设计说明书的目的就是进一步细化软件设计阶段得出的软件总体概貌，把它加工成在程序细节上非常接近于源程序的软件表示。

### 1.2背景
#### 此项目由北京信息科技大学发布招标、111队接受委托开发

### 1.3定义与缩写
### 在该概要设计说明书中的专门术语有：

#### 1.3.1 总体设计
#### 解释：
##### 即对全局问题的设计，也就是设计系统总的处理方案，又称概要设计

#### 1.3.2 接口设计
#### 解释：
##### 软件内部，软件和操作系统间以及软件和人之间如何通信。

#### 1.3.3 数据结构设计
#### 解释：
##### 数据结构是在整个计算机科学与技术领域上广泛被使用的术语。它用来反映一个数据的内部构成，即一个数据由那些成分数据构成，以什么方式构成，呈什么结构。
##### 数据结构有逻辑上的数据结构和物理上的数据结构之分。逻辑上的数据结构反映成分数据之间的逻辑关系，而物理上的数据结构反映成分数据在计算机内部的存储安排。
##### 数据结构主要有三个方面内容：数据的逻辑结构；数据的物理存储结构；对数据的操作或算法。

#### 1.3.4 运行设计
#### 解释：
 1. 运行模块的组合
 2. 运行控制
 3. 运行时间

#### 1.3.6 出错设计
#### 解释：
##### 指软件产品中存在的导致期望的运行结果和实际运行结果间出现差异的一系列问题，这些问题包括故障、失效、缺陷。人为的将错误以某种方式让用户知道。

#### 1.3.5 SQL
#### 解释：
##### Structured Query Language（结构化查询语言）数据结构为关系型数据库，所以，在程序中可以通过 标准的SQL语句与数据结构进行交互，交互过程中采用通用的数据库访问接口。本软件通过springboot连接数据库，因此只要主机上spring boot服务程序即可以与Mysql数据库进行连接，实现对数据库的访问。

#### 1.3.5 JDBC
#### 解释：
##### 连接数据库使用的jar包


#### 1.3.5 拦截器
#### 解释：
##### 拦截所有外部请求

#### 1.3.5 crud
#### 解释：
##### 数据库增删改查操作

### 1.4参考资料
#### 《开发计划》
#### 《需求规格说明书》




## 2 总体设计
### 2.1 需求规定:
> - 输入项目：  
    > 1.用户的注册登录    
    > 2.用户的销售商品   
    > 3.商品信息    
    > 4.商品是否允许议价  
    > 5.商品数量    
    > 6.商品价格  
    > 7.商品的新旧程度  
    > 8.商品评价
> - 输出项目：  
    > 1.销售订单   
    > 2.商品的列表  
    > 3.购物车列表  
    > 4.详细物流数据
> - 处理的功能新要求：  
    > 1.管理员用户审核商品、审核用户注册、管理用户列表    
    > 2.钱包和积分功能  
    > 3.刷新以实时更新物流数据

### 2.2 运行环境
>1.  Windows7及以上、Linux系统
>2.  联网才能进行软件正常的使用
>3.  未登录用户不能浏览商品信息，登录后才可以使用软件基本功能

### 2.3 基本设计理念和处理流程：

### 2.4 结构：

![img_1.png](img_1.png)

### 2.5 功能需求与各部分程序的关系：
- 本条用一张如下的矩阵图说明各项功能需求的实现同各模块程序的关系：

|     |  登录  |  输入  |  输出   |  检测  |   
| :-----:| :---: | :----: | :---: | :---: |
| 登录 | √  |  √  |   |   |
| 注册 | √  |  √  |   |   |
| 上架商品 |  |  √  | √ |   |
| 购物车 |  |  √  | √  |   |
| 发布订单 |  |  √  | √  |  √ |
### 2.6 人工处理流程：
交易过程中买卖双方出现意见分歧，需要人工介入进行调解。
### 2.7 尚未解决的问题：
1. 用户过多并发使用可能会导致软件崩溃，需要进行压力测试。
2. 商品交易及订单生成是否有过高延迟，需要进行软件测试。
### 2.8 自由表述：
> 无



## 3接口设计
### 3.1用户接口
1. 收货地址业务层的接口，用于对地址的增删改查<br>
   public interface IAddressService  
2. 购物车业务层的接口，用于购物车的获取以及对购物车中商品的添加和更新，<br>
   public interface ICartService  
3. 地区业务层的接口， 根据code查询区域名称<br>
   public interface IDistrictService  
4. 订单业务层的接口，用于创建订单和查询列表<br>
   public interface IOrderService  
5. 商品业务层的接口，对商品的增删改查和对热搜商品的排序<br>
   public interface IProductService
6. 用户业务层的接口,用于用户注册，登录，修改密码，修改头像，以及对用户进行查找和更新<br>
   public interface IUserService  
### 3.2外部接口
#### 3.2.1硬件接口
1. 光纤
2. usb
3. 电源
#### 3.2.2软件接口
1. 获取当前商家待发货所有商品信息
2. 返回当前商家所有的待发货的商品信息
3. 支付接口，通过调用支付宝接口支付
### 3.3内部接口

1. 收货地址持久层的接口
    
    public interface AddressMapper;
   

   插入用户的收货地址数据
   
     Integer insert(Address address);

   
   根据用户id统计收货地址数量

     Integer countByUid(Integer uid);

   
   根据用户id查询用户收获地址数据
   
    List<Address> findByUid(Integer uid);

   
   根据aid查询收货地址数据
   
     Address findByAid(Integer aid);

   
   根据用户的uid值来修改用户的收货地址设置为非默认
   
     Integer updateNonDefault(Integer uid);

   
   根据收货地址id删除收货地址数据
   
     Integer deleteByAid(Integer aid);

   
   根据用户uid查询当前用户最后一次被修改的收货地址数据
   
     Address findLastModified(Integer uid);


   更新用户地址信息
   
     Integer updateInfoByAid(Address address);
     
2. 购物车持久层的接口
   
    public interface CartMapper

   
   插入购物车数据
   
     Integer insert(Cart cart);
   
   更新购物车某件商品数量
   
     Integer updateNumByCid(Integer cid, Integer num, String modifiedUser, Date modifiedTime);

   
   根据用户id与商品id来查询购物车中数据
   
     Cart findByUidAndPid(Integer uid,Integer pid);

   
   根据用户uid查询VO类用户加入购物车的商品列表
   
     List<CartVO> findVOByUid(Integer uid);

   
   根据购物车cid值查询商品
   
     Cart findByCid(Integer cid);

   
   根据若干个购物车数据id查询详情的列表
   
     List<CartVO> findVOByCids(Integer[] cids);
3. 地区持久层的接口
   
    public interface DistrictMapper

   
   根据父代号查询区域信息
   
     List<District> findByParent(String  parent);

   
   根据code查询区域名称
   
     String findNameByCode(String code);
4. 订单持久层的接口
   
    public interface OrderMapper

   
   插入订单数据
   
     Integer insertOrder(Order order);

   
   插入订单项的数据
   
     Integer insertOrderItem(OrderItem orderItem);

   
   根据订单id查询详情的列表
   
     List<OrderVO> findVOByOid(Integer oid);
5. 商品持久层的接口
   
    public interface ProductMapper

   
   查询热销商品的前四名
   
     List<Product> findHotList();

   
   查询评分最高商品前四名
   
     List<Product> findMarkList();

   
   查询最贵的前四件商品
   
     List<Product> findDescList();

   
   查询最便宜的前四件商品
   
     List<Product> findAscList();

   根据商品id查询商品详情
   
    Product findById(Integer id);

   
   根据商品名查询商品详情
   
     List<Product> findByTitle(String title);

   
   查询所有在售商品
   
     List<Product> findAllProducts();

   
   发布商品
   
     Integer insert(Product product);
6. 用户持久层的接口
   
    public interface UserMapper

   
   插入用户的数据
   
     Integer insert(User user);

   
   根据用户名查询用户数据
   
     User findByUsername(String username);

   
   根据用户uid来修改用户密码
   
     Integer updatePasswordByYid(Integer uid, String password,
     String modifiedUser, Date modifiedTime);

   
   根据用户id查询用户的数据
   
     User findByUid(Integer uid);

   
   更新用户的数据信息
   
     Integer updateInfoByUid(User user);

   
   根据用户uid值修改用户头像

     Integer updateAvatarByUid(@Param("uid") Integer uid,
     @Param("avatar") String avatar,
     @Param("modifiedUser") String modifiedUser,
     @Param("modifiedTime")  Date modifiedTime);

## 4运行设计
### 4.1运行模块组合
1. 用户：登录模块+注册模块+商家注册模块+购物车模块
2. 主页：商品模块
3. 商家：管理商品模块+订单模块+退款模块
4. 管理员：登录模块+审核模块+商家管理模块
### 4.2运行控制
1. 在客户端登录后数据库验证账号密码，通过后进入主界面；
2. 新用户注册，提交用户名、密码、短信验证码；
3. 管理员通过注册请求，更新数据库；
4. 主界面显示当前所有在售的商品；
5. 用户购买商品，填写收货信息并付款；
6. 商家发货，买家确认收货，购买流程结束；
7. 商家申请上架商品，提交商品图片和信息审核；
8. 管理员审核商品上架，上架商品流程结束。
### 4.3运行时间
1. 本系统的各个模块之间功能是相互联系的，故各模块占用各种资源的时间是累计的，所以运行时间由顾客
的操作和网络的运行速度决定。
2. 时间规定：用户点击按钮，服务器综合响应时间不超过2s、数据库查询不超过1s、数据处理不得超过1s。


## 5系统数据结构设计
### 5.1逻辑结构设计要点
本系统使用MySql完成数据的存储与数据交互，创建数据库名为store2019011292


_**t_address表**_

<table>
<tr>
    <th>名称</th>
    <th>类型</th>

</tr>
<tr>
    <td>aid</td>
    <td>int</td>

</tr>
<tr>
    <td>uid</td>
    <td>int</td>

</tr>
<tr>
    <td>name</td>
    <td>varchar</td>

</tr>
<tr>
    <td>Province_name</td>
    <td>varchar</td>

</tr>
<tr>
    <td>Province_code</td>
    <td>char</td>

</tr>
<tr>
    <td>city_name</td>
    <td>varchar</td>

</tr>
<tr>
    <td>city_code</td>
    <td>char</td>

</tr>
<tr>
    <td>area_name</td>
    <td>varchar</td>

</tr>
<tr>
    <td>area_code</td>
    <td>char</td>

</tr>
<tr>
    <td>zip</td>
    <td>char</td>

</tr>
<tr>
    <td>address</td>
    <td>varchar</td>

</tr>
<tr>
    <td>phone</td>
    <td>varchar</td>

</tr>
<tr>
    <td>tel</td>
    <td>varchar</td>

</tr>
<tr>
    <td>tag</td>
    <td>varchar</td>

</tr>
<tr>
    <td>is_default</td>
    <td>int</td>

</tr>
<tr>
    <td>created_user</td>
    <td>varchar</td>

</tr>
<tr>
    <td>created_time</td>
    <td>datetime</td>

</tr>
<tr>
    <td>modified_user</td>
    <td>varchar</td>

</tr>
<tr>
    <td>modified_time</td>
    <td>datetime</td>

</tr>

</table>

_**t_cart表**_
<table>
<tr>
    <th>名称</th>
    <th>类型</th>

</tr>
<tr>
    <td>cid</td>
    <td>int</td>

</tr>
<tr>
    <td>uid</td>
    <td>int</td>

</tr>
<tr>
    <td>pid</td>
    <td>int</td>

</tr>
<tr>
    <td>price</td>
    <td>bigint</td>

</tr>
<tr>
    <td>num</td>
    <td>int</td>

</tr>
<tr>
    <td>created_user</td>
    <td>varchar</td>

</tr>
<tr>
    <td>created_time</td>
    <td>datatime</td>

</tr>
<tr>
    <td>modified_user</td>
    <td>varchar</td>

</tr>
<tr>
    <td>modified_time</td>
    <td>datatime</td>

</tr>
<tr>
    <td>cstatus</td>
    <td>int</td>

</tr>
</table>  


_**t_comment表**_
<table>
<tr>
    <th>名称</th>
    <th>类型</th>
   
</tr>
<tr>
    <td>id</td>
    <td>int</td>
    
</tr>
<tr>
    <td>uid</td>
    <td>int</td>
    
</tr>
<tr>
    <td>bid</td>
    <td>int</td>
    
</tr>
<tr>
    <td>oid</td>
    <td>int</td>
    
</tr>
<tr>
    <td>pid</td>
    <td>int</td>
    
</tr>
<tr>
    <td>p_comment</td>
    <td>varchar</td>
   
</tr>
<tr>
    <td>b_comment</td>
    <td>varchar</td>
    
</tr>
<tr>
    <td>judge_mark</td>
    <td>int</td>
   
</tr>
<tr>
    <td>reply</td>
    <td>varchar</td>
 
</tr>
<tr>
    <td>created_user</td>
    <td>varchar</td>
  
</tr>
<tr>
    <td>created_time</td>
    <td>datatime</td>
   
</tr>
<tr>
    <td>modified_user</td>
    <td>varchar</td>
   
</tr>
<tr>
    <td>modified_time</td>
    <td>datatime</td>
   
</tr>
</table>  



_**t_dict_district表**_
<table>
<tr>
    <th>名称</th>
    <th>类型</th>
   
</tr>
<tr>
    <td>id</td>
    <td>int</td>
   
</tr>
<tr>
    <td>parent</td>
    <td>varchar</td>
    
</tr>
<tr>
    <td>code</td>
    <td>varchar</td>
    
</tr>
<tr>
    <td>name</td>
    <td>varchar</td>
   
</tr>
</table>



**t_order表**
<table>
<tr>
    <th>名称</th>
    <th>类型</th>
    
</tr>
<tr>
    <td>oid</td>
    <td>int</td>
  
</tr>
<tr>
    <td>uid</td>
    <td>int</td>
  
</tr>
<tr>
    <td>recv_name</td>
    <td>varchar</td>
    
</tr>
<tr>
    <td>recv_phone</td>
    <td>varchar</td>
    
</tr>
<tr>
    <td>recv_province</td>
    <td>varchar</td>
  
</tr>
<tr>
    <td>recv_city</td>
    <td>varchar</td>
    
</tr>
<tr>
    <td>recv_area</td>
    <td>varchar</td>
   
</tr>
<tr>
    <td>recv_address</td>
    <td>varchar</td>
    
</tr>
<tr>
    <td>total_price</td>
    <td>bigint</td>
   
</tr>
<tr>
    <td>status</td>
    <td>int</td>
   
</tr>
<tr>
    <td>order_time</td>
    <td>datetime</td>
    
</tr>
<tr>
    <td>pay_time</td>
    <td>datetime</td>
    
</tr>

<tr>
    <td>created_user</td>
    <td>varchar</td>
    
</tr>
<tr>
    <td>created_time</td>
    <td>datatime</td>
   
</tr>
<tr>
    <td>modified_user</td>
    <td>varchar</td>
   
</tr>
<tr>
    <td>modified_time</td>
    <td>datatime</td>
  
</tr>
</table>



_**t_order_item表**_
<table>
<tr>
    <th>名称</th>
    <th>类型</th>
    
</tr>
<tr>
    <td>id</td>
    <td>int</td>
 
</tr>
<tr>
    <td>oid</td>
    <td>int</td>
   
</tr>
<tr>
    <td>pid</td>
    <td>int</td>
   
</tr>
<tr>
    <td>title</td>
    <td>varchar</td>
   
</tr>
<tr>
    <td>image</td>
    <td>varchar</td>
    
</tr>
<tr>
    <td>price</td>
    <td>bigint</td>
   
</tr>
<tr>
    <td>num</td>
    <td>int</td>
    
</tr>
<tr>
    <td>created_user</td>
    <td>varchar</td>
  
</tr>
<tr>
    <td>created_time</td>
    <td>datatime</td>
  
</tr>
<tr>
    <td>modified_user</td>
    <td>varchar</td>
   
</tr>
<tr>
    <td>modified_time</td>
    <td>datatime</td>
  
</tr>
<tr>
    <td>p_status</td>
    <td>int</td>
   
</tr>
</table>


**t_purse_record_user表**
<table>
<tr>
    <th>名称</th>
    <th>类型</th>
    
</tr>
<tr>
    <td>id</td>
    <td>int</td>
   
</tr>
<tr>
    <td>uid</td>
    <td>int</td>
    
</tr>
<tr>
    <td>username</td>
    <td>varchar</td>
 
</tr>
<tr>
    <td>purse</td>
    <td>int</td>
    
</tr>
<tr>
    <td>add_count</td>
    <td>int</td>
    
</tr>
<tr>
    <td>sub_count</td>
    <td>int</td>
   
</tr>
<tr>
    <td>pid</td>
    <td>int</td>
    
</tr>
<tr>
    <td>created_user</td>
    <td>varchar</td>
    
</tr>
<tr>
    <td>created_time</td>
    <td>datatime</td>
    
</tr>
<tr>
    <td>modified_user</td>
    <td>varchar</td>
    
</tr>
<tr>
    <td>modified_time</td>
    <td>datatime</td>
   
</tr>
</table>










给出本系统内所使用的每个数据结构的名称、标识符以及它们之中每个数据项、记录、文卷和系的标识、定义、长度及它们之间的层次的或表格的相互关系。
### 5.2物理结构设计要点


给出本系统内所使用的每个数据结构中的每个数据项的存储要求，访问方法、存取单位、存取的物理关系（索引、设备、存储区域）、设计考虑和保密条件。
### 5.3数据结构与程序的关系
说明各个数据结构与访问这些数据结构的形式:



## 6系统出错处理设计
### 6.1出错信息
用一览表的方式说朗每种可能的出错或故障情况出现时，系统输出信息的形式、含意及处理方法。
### 6.2补救措施
说明故障出现后可能采取的变通措施，包括：
a.	后备技术说明准备采用的后备技术，当原始系统数据万一丢失时启用的副本的建立和启动的技术，例如周期性地把磁盘信息记录到磁带上去就是对于磁盘媒体的一种后备技术；
b.	降效技术说明准备采用的后备技术，使用另一个效率稍低的系统或方法来求得所需结果的某些部分，例如一个自动系统的降效技术可以是手工操作和数据的人工记录；
c.	恢复及再启动技术说明将使用的恢复再启动技术，使软件从故障点恢复执行或使软件从头开始重新运行的方法。
### 6.3系统维护设计
说明为了系统维护的方便而在程序内部设计中作出的安排，包括在程序中专门安排用于系统的检查与维护的检测点和专用模块。 各个程序之间的对应关系，可采用如下的矩阵图的形式；


6系统出错处理设计
6.1出错信息
用一览表的方式说朗每种可能的出错或故障情况出现时，系统输出信息的形式、含意及处理方法。

在用户使用错误的数据或访问没有权限的数据以及在用户操作非法时，系统会给出相应的警告提示。

6.2补救措施
由于数据在数据库中已经有备份，故在系统出错后可以依靠数据库的回复功能，并且依靠日志文件使系统再启动，就算系统崩溃用户数据也不会丢失或遭到破坏。但有可能占用更多的数据存储空间，权衡措施由用户自己来决定。

6.3系统维护设计
由于系统比较简单，没有加载维护模块，此项内容省略。
————————————————
版权声明：本文为CSDN博主「Michael-杨楠」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。
原文链接：https://blog.csdn.net/tgbyn/article/details/53837110